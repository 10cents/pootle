jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(b,a,c,d,e){return jQuery.easing[jQuery.easing.def](b,a,c,d,e)},easeInQuad:function(b,a,c,d,e){return d*(a/=e)*a+c},easeOutQuad:function(b,a,c,d,e){return-d*(a/=e)*(a-2)+c},easeInOutQuad:function(b,a,c,d,e){return(a/=e/2)<1?d/2*a*a+c:-d/2*(--a*(a-2)-1)+c},easeInCubic:function(b,a,c,d,e){return d*(a/=e)*a*a+c},easeOutCubic:function(b,a,c,d,e){return d*((a=a/e-1)*a*a+1)+c},easeInOutCubic:function(b,a,c,d,e){return(a/=e/2)<1?d/2*a*a*a+c:d/
2*((a-=2)*a*a+2)+c},easeInQuart:function(b,a,c,d,e){return d*(a/=e)*a*a*a+c},easeOutQuart:function(b,a,c,d,e){return-d*((a=a/e-1)*a*a*a-1)+c},easeInOutQuart:function(b,a,c,d,e){return(a/=e/2)<1?d/2*a*a*a*a+c:-d/2*((a-=2)*a*a*a-2)+c},easeInQuint:function(b,a,c,d,e){return d*(a/=e)*a*a*a*a+c},easeOutQuint:function(b,a,c,d,e){return d*((a=a/e-1)*a*a*a*a+1)+c},easeInOutQuint:function(b,a,c,d,e){return(a/=e/2)<1?d/2*a*a*a*a*a+c:d/2*((a-=2)*a*a*a*a+2)+c},easeInSine:function(b,a,c,d,e){return-d*Math.cos(a/
e*(Math.PI/2))+d+c},easeOutSine:function(b,a,c,d,e){return d*Math.sin(a/e*(Math.PI/2))+c},easeInOutSine:function(b,a,c,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+c},easeInExpo:function(b,a,c,d,e){return a==0?c:d*Math.pow(2,10*(a/e-1))+c},easeOutExpo:function(b,a,c,d,e){return a==e?c+d:d*(-Math.pow(2,-10*a/e)+1)+c},easeInOutExpo:function(b,a,c,d,e){return a==0?c:a==e?c+d:(a/=e/2)<1?d/2*Math.pow(2,10*(a-1))+c:d/2*(-Math.pow(2,-10*--a)+2)+c},easeInCirc:function(b,a,c,d,e){return-d*(Math.sqrt(1-(a/=e)*
a)-1)+c},easeOutCirc:function(b,a,c,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+c},easeInOutCirc:function(b,a,c,d,e){return(a/=e/2)<1?-d/2*(Math.sqrt(1-a*a)-1)+c:d/2*(Math.sqrt(1-(a-=2)*a)+1)+c},easeInElastic:function(b,a,c,d,e){var b=1.70158,f=0,g=d;if(a==0)return c;if((a/=e)==1)return c+d;f||(f=e*0.3);g<Math.abs(d)?(g=d,b=f/4):b=f/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin((a*e-b)*2*Math.PI/f))+c},easeOutElastic:function(b,a,c,d,e){var b=1.70158,f=0,g=d;if(a==0)return c;if((a/=
e)==1)return c+d;f||(f=e*0.3);g<Math.abs(d)?(g=d,b=f/4):b=f/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*a)*Math.sin((a*e-b)*2*Math.PI/f)+d+c},easeInOutElastic:function(b,a,c,d,e){var b=1.70158,f=0,g=d;if(a==0)return c;if((a/=e/2)==2)return c+d;f||(f=e*0.3*1.5);g<Math.abs(d)?(g=d,b=f/4):b=f/(2*Math.PI)*Math.asin(d/g);return a<1?-0.5*g*Math.pow(2,10*(a-=1))*Math.sin((a*e-b)*2*Math.PI/f)+c:g*Math.pow(2,-10*(a-=1))*Math.sin((a*e-b)*2*Math.PI/f)*0.5+d+c},easeInBack:function(b,a,c,d,e,f){f==void 0&&
(f=1.70158);return d*(a/=e)*a*((f+1)*a-f)+c},easeOutBack:function(b,a,c,d,e,f){f==void 0&&(f=1.70158);return d*((a=a/e-1)*a*((f+1)*a+f)+1)+c},easeInOutBack:function(b,a,c,d,e,f){f==void 0&&(f=1.70158);return(a/=e/2)<1?d/2*a*a*(((f*=1.525)+1)*a-f)+c:d/2*((a-=2)*a*(((f*=1.525)+1)*a+f)+2)+c},easeInBounce:function(b,a,c,d,e){return d-jQuery.easing.easeOutBounce(b,e-a,0,d,e)+c},easeOutBounce:function(b,a,c,d,e){return(a/=e)<1/2.75?d*7.5625*a*a+c:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+c:a<2.5/2.75?d*
(7.5625*(a-=2.25/2.75)*a+0.9375)+c:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+c},easeInOutBounce:function(b,a,c,d,e){return a<e/2?jQuery.easing.easeInBounce(b,a*2,0,d,e)*0.5+c:jQuery.easing.easeOutBounce(b,a*2-e,0,d,e)*0.5+d*0.5+c}});(function(b){function a(a){function d(a){var c=RegExp(b.map(a,encodeURIComponent).join("|"),"ig");return function(a){return a.replace(c,decodeURIComponent)}}a=b.extend({unescape:!1},a||{});c.encoder=function(a){return a===!0?function(a){return a}:typeof a=="string"&&(a=d(a.split("")))||typeof a=="function"?function(b){return a(encodeURIComponent(b))}:encodeURIComponent}(a.unescape)}var c={put:function(a,b){(b||window).location.hash=this.encoder(a)},get:function(a){return(a||window).location.toString().split("#",
2)[1]||""},encoder:encodeURIComponent},d={id:"__jQuery_history",init:function(){var a='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';b("body").prepend(a);return this},_document:function(){return b("#"+this.id)[0].contentWindow.document},put:function(a){var b=this._document();b.open();b.close();c.put(a,b)},get:function(){return c.get(this._document())}},e={base:{callback:void 0,type:void 0,check:function(){},load:function(){},init:function(b,c){a(c);f.callback=b;f._options=
c;f._init()},_init:function(){},_options:{}},timer:{_appState:void 0,_init:function(){var a=c.get();f._appState=a;f.callback(a);setInterval(f.check,100)},check:function(){var a=c.get();if(a!=f._appState)f._appState=a,f.callback(a)},load:function(a){if(a!=f._appState)c.put(a),f._appState=a,f.callback(a)}},iframeTimer:{_appState:void 0,_init:function(){var a=c.get();f._appState=a;d.init().put(a);f.callback(a);setInterval(f.check,100)},check:function(){var a=d.get(),b=c.get();if(b!=a)b==f._appState?
(f._appState=a,c.put(a),f.callback(a)):(f._appState=b,d.put(b),f.callback(b))},load:function(a){if(a!=f._appState)c.put(a),d.put(a),f._appState=a,f.callback(a)}},hashchangeEvent:{_init:function(){f.callback(c.get());b(window).bind("hashchange",f.check)},check:function(){f.callback(c.get())},load:function(a){c.put(a)}}},f=b.extend({},e.base);f.type=b.browser.msie&&(b.browser.version<8||document.documentMode<8)?"iframeTimer":"onhashchange"in window?"hashchangeEvent":"timer";b.extend(f,e[f.type]);b.history=
f})(jQuery);(function(b){function a(a,c,d,e){e={data:e||(c?c.data:{}),_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:j,nest:i,wrap:n,html:k,update:p};a&&b.extend(e,a,{nodes:[],parent:c});if(d)e.tmpl=d,e._ctnt=e._ctnt||e.tmpl(b,e),e.key=++v,(A.length?o:s)[v]=e;return e}function c(a,e,f){var g,f=f?b.map(f,function(b){return typeof b==="string"?a.key?b.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+q+'="'+a.key+'" $2'):b:c(b,a,b._ctnt)}):a;if(e)return f;f=f.join("");f.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(a,c,e,f){g=b(e).get();h(g);c&&(g=d(c).concat(g));f&&(g=g.concat(d(f)))});return g?g:d(f)}function d(a){var c=document.createElement("div");c.innerHTML=a;return b.makeArray(c.childNodes)}function e(a){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+b.trim(a).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(a,c,d,e,f,h,i){a=b.tmpl.tag[d];if(!a)throw"Template command not found: "+d;d=a._default||[];h&&!/\w$/.test(f)&&(f+=h,h="");f?(f=g(f),i=i?","+g(i)+")":h?")":"",i=h?f.indexOf(".")>-1?f+h:"("+f+").call($item"+i:f,h=h?i:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):h=i=d.$1||"null";e=g(e);return"');"+a[c?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(h).split("$1").join(i).split("$2").join(e?e.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,
function(a,b,c,d){return(d=d?","+d+")":c?")":"")?"("+b+").call($item"+d:a}):d.$2||"")+"_.push('"})+"');}return _;")}function f(a,d){a._wrap=c(a,!0,b.isArray(d)?d:[u.test(d)?d:b(d).html()]).join("")}function g(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function h(c){function d(c){function f(b){var w;b+=e;w=h[b]=h[b]||a(j,s[j.parent.key+e]||j.parent,null,!0),j=w}var g,i=c,j,k;if(k=c.getAttribute(q)){for(;i.parentNode&&(i=i.parentNode).nodeType===1&&!(g=i.getAttribute(q)););if(g!==
k){i=i.parentNode?i.nodeType===11?0:i.getAttribute(q)||0:0;if(!(j=s[k]))j=o[k],j=a(j,s[i]||o[i],null,!0),j.key=++v,s[v]=j;x&&f(k)}c.removeAttribute(q)}else if(x&&(j=b.data(c,"tmplItem")))f(j.key),s[j.key]=j,i=(i=b.data(c.parentNode,"tmplItem"))?i.key:0;if(j){for(g=j;g&&g.key!=i;)g.nodes.push(c),g=g.parent;delete j._ctnt;delete j._wrap;b.data(c,"tmplItem",j)}}var e="_"+x,f,g,h={},i,j,k;i=0;for(j=c.length;i<j;i++)if((f=c[i]).nodeType===1){g=f.getElementsByTagName("*");for(k=g.length-1;k>=0;k--)d(g[k]);
d(f)}}function j(a,b,c,d){if(!a)return A.pop();A.push({_:a,tmpl:b,item:this,data:c,options:d})}function i(a,c,d){return b.tmpl(b.template(a),c,d,this)}function n(a,c){var d=a.options||{};d.wrapped=c;return b.tmpl(b.template(a.tmpl),a.data,d,a.item)}function k(a,c){var d=this._wrap;return b.map(b(b.isArray(d)?d.join(""):d).filter(a||"*"),function(a){if(c)a=a.innerText||a.textContent;else{var b;if(!(b=a.outerHTML))b=document.createElement("div"),b.appendChild(a.cloneNode(!0)),b=b.innerHTML;a=b}return a})}
function p(){var a=this.nodes;b.tmpl(null,null,null,this).insertBefore(a[0]);b(a).remove()}var r=b.fn.domManip,q="_tmplitem",u=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,s={},o={},t,y={key:0,data:{}},v=0,x=0,A=[];b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,c){b.fn[a]=function(d){var e=[],d=b(d),f,g,h;f=this.length===1&&this[0].parentNode;t=s||{};if(f&&f.nodeType===11&&f.childNodes.length===1&&d.length===1)d[c](this[0]),e=this;
else{g=0;for(h=d.length;g<h;g++)x=g,f=(g>0?this.clone(!0):this).get(),b.fn[c].apply(b(d[g]),f),e=e.concat(f);x=0;e=this.pushStack(e,a,d.selector)}d=t;t=null;b.tmpl.complete(d);return e}});b.fn.extend({tmpl:function(a,c,d){return b.tmpl(this[0],a,c,d)},tmplItem:function(){return b.tmplItem(this[0])},template:function(a){return b.template(a,this[0])},domManip:function(a,c,d,e){if(a[0]&&a[0].nodeType){for(var f=b.makeArray(arguments),g=a.length,h=0,i;h<g&&!(i=b.data(a[h++],"tmplItem")););g>1&&(f[0]=
[b.makeArray(a)]);i&&x&&(f[2]=function(a){b.tmpl.afterManip(this,a,d)});r.apply(this,f)}else r.apply(this,arguments);x=0;t||b.tmpl.complete(s);return this}});b.extend({tmpl:function(d,e,g,h){var i=!h;if(i)h=y,d=b.template[d]||b.template(null,d),o={};else if(!d)return d=h.tmpl,s[h.key]=h,h.nodes=[],h.wrapped&&f(h,h.wrapped),b(c(h,null,h.tmpl(b,h)));if(!d)return[];typeof e==="function"&&(e=e.call(h||{}));g&&g.wrapped&&f(g,g.wrapped);e=b.isArray(e)?b.map(e,function(b){return b?a(g,h,d,b):null}):[a(g,
h,d,e)];return i?b(c(h,null,e)):e},tmplItem:function(a){var c;for(a instanceof b&&(a=a[0]);a&&a.nodeType===1&&!(c=b.data(a,"tmplItem"))&&(a=a.parentNode););return c||y},template:function(a,c){return c?(typeof c==="string"?c=e(c):c instanceof b&&(c=c[0]||{}),c.nodeType&&(c=b.data(c,"tmpl")||b.data(c,"tmpl",e(c.innerHTML))),typeof a==="string"?b.template[a]=c:c):a?typeof a!=="string"?b.template(null,a):b.template[a]||b.template(null,u.test(a)?a:b(a)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
b.extend(b.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},
open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){s={}},afterManip:function(a,c,d){var e=c.nodeType===11?b.makeArray(c.childNodes):c.nodeType===1?[c]:[];d.call(a,c);h(e);x++}})})(jQuery);(function(b,a){function c(){}function d(a){F=[a]}function e(a,b,c){return a&&a.apply(b.context||b,c)}function f(f){function I(b){!B++&&a(function(){E();C&&(x[w]={s:[b]});K&&(b=K.apply(f,[b]));e(f.success,f,[b,o]);e(J,f,[f,o])},0)}function G(b){!B++&&a(function(){E();C&&b!=t&&(x[w]=b);e(f.error,f,[f,b]);e(J,f,[f,b])},0)}var f=b.extend({},H,f),J=f.complete,K=f.dataFilter,L=f.callbackParameter,M=f.callback,P=f.cache,C=f.pageCache,N=f.charset,w=f.url,z=f.data,O=f.timeout,D,B=0,E=c;f.abort=function(){!B++&&
E()};if(e(f.beforeSend,f,[f])===!1||B)return f;w=w||j;z=z?typeof z=="string"?z:b.param(z,f.traditional):j;w+=z?(/\?/.test(w)?"&":"?")+z:j;L&&(w+=(/\?/.test(w)?"&":"?")+encodeURIComponent(L)+"=?");!P&&!C&&(w+=(/\?/.test(w)?"&":"?")+"_"+(new Date).getTime()+"=");w=w.replace(/=\?(&|$)/,"="+M+"$1");C&&(D=x[w])?D.s?I(D.s[0]):G(D):a(function(e,f,j){if(!B){j=O>0&&a(function(){G(t)},O);E=function(){j&&clearTimeout(j);e[q]=e[k]=e[r]=e[p]=null;v[u](e);f&&v[u](f)};window[M]=d;e=b(s)[0];e.id=n+A++;N&&(e[h]=N);
var o=function(a){(e[k]||c)();a=F;F=void 0;a?I(a[0]):G(i)};y.msie?(e.event=k,e.htmlFor=e.id,e[q]=function(){/loaded|complete/.test(e.readyState)&&o()}):(e[p]=e[r]=o,y.opera?(f=b(s)[0]).text="jQuery('#"+e.id+"')[0]."+p+"()":e[g]=g);e.src=w;v.insertBefore(e,v.firstChild);f&&v.insertBefore(f,v.firstChild)}},0);return f}var g="async",h="charset",j="",i="error",n="_jqjsp",k="onclick",p="on"+i,r="onload",q="onreadystatechange",u="removeChild",s="<script/>",o="success",t="timeout",y=b.browser,v=b("head")[0]||
document.documentElement,x={},A=0,F,H={callback:n,url:location.href};f.setup=function(a){b.extend(H,a)};b.jsonp=f})(jQuery,setTimeout);(function(b){b.fn.TextAreaExpander=function(a,c){function d(a){var a=a.target||a,b=a.value.length,c=a.offsetWidth;if(b!=a.valLength||c!=a.boxWidth){if(e&&(b<a.valLength||c!=a.boxWidth))a.style.height="0px";var d=Math.max(a.expandMin,Math.min(a.scrollHeight,a.expandMax));a.style.overflow=a.scrollHeight>d?"auto":"hidden";a.style.height=d+"px";a.valLength=b;a.boxWidth=c}return!0}var e=!(b.browser.msie||b.browser.opera);this.each(function(){if(this.nodeName.toLowerCase()=="textarea"){var e=this.className.match(/expand(\d+)\-*(\d+)*/i);
this.expandMin=a||(e?parseInt("0"+e[1],10):0);this.expandMax=c||(e?parseInt("0"+e[2],10):99999);d(this);if(!this.Initialized)this.Initialized=!0,b(this).css("padding-top",0).css("padding-bottom",0),b(this).bind("keyup",d).bind("focus",d)}});return this}})(jQuery);$(document).ready(function(){$("textarea[class*=expand]").TextAreaExpander()});function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Diff_DualThreshold=32;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=function(){for(var b=0,a=1,c=2;a!=c;)b++,a=c,c<<=1;return b}()}var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;
diff_match_patch.prototype.diff_main=function(b,a,c,d){typeof d=="undefined"&&(d=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+this.Diff_Timeout*1E3);if(b==null||a==null)throw Error("Null input. (diff_main)");if(b==a)return b?[[DIFF_EQUAL,b]]:[];typeof c=="undefined"&&(c=!0);var e=c,f=this.diff_commonPrefix(b,a),c=b.substring(0,f),b=b.substring(f),a=a.substring(f),f=this.diff_commonSuffix(b,a),g=b.substring(b.length-f),b=b.substring(0,b.length-f),a=a.substring(0,a.length-f),b=this.diff_compute(b,
a,e,d);c&&b.unshift([DIFF_EQUAL,c]);g&&b.push([DIFF_EQUAL,g]);this.diff_cleanupMerge(b);return b};
diff_match_patch.prototype.diff_compute=function(b,a,c,d){var e;if(!b)return[[DIFF_INSERT,a]];if(!a)return[[DIFF_DELETE,b]];e=b.length>a.length?b:a;var f=b.length>a.length?a:b,g=e.indexOf(f);if(g!=-1)return e=[[DIFF_INSERT,e.substring(0,g)],[DIFF_EQUAL,f],[DIFF_INSERT,e.substring(g+f.length)]],b.length>a.length&&(e[0][0]=e[2][0]=DIFF_DELETE),e;if(e=this.diff_halfMatch(b,a))return b=e[1],a=e[3],d=e[4],e=this.diff_main(e[0],e[2],c),c=this.diff_main(b,a,c),e.concat([[DIFF_EQUAL,d]],c);if(c&&(b.length<
100||a.length<100))c=!1;var h;c&&(h=this.diff_linesToChars(b,a),b=h[0],a=h[1],h=h[2]);e=this.diff_map(b,a,d);if(c){this.diff_charsToLines(e,h);this.diff_cleanupSemantic(e);e.push([DIFF_EQUAL,""]);a=b=c=0;for(f=h="";c<e.length;){switch(e[c][0]){case DIFF_INSERT:a++;f+=e[c][1];break;case DIFF_DELETE:b++;h+=e[c][1];break;case DIFF_EQUAL:if(b>=1&&a>=1){h=this.diff_main(h,f,!1,d);e.splice(c-b-a,b+a);c=c-b-a;for(b=h.length-1;b>=0;b--)e.splice(c,0,h[b]);c+=h.length}b=a=0;f=h=""}c++}e.pop()}return e};
diff_match_patch.prototype.diff_linesToChars=function(b,a){function c(a){for(var b="",c=0,f=-1,g=d.length;f<a.length-1;){f=a.indexOf("\n",c);f==-1&&(f=a.length-1);var p=a.substring(c,f+1),c=f+1;(e.hasOwnProperty?e.hasOwnProperty(p):e[p]!==void 0)?b+=String.fromCharCode(e[p]):(b+=String.fromCharCode(g),e[p]=g,d[g++]=p)}return b}var d=[],e={};d[0]="";var f=c(b),g=c(a);return[f,g,d]};
diff_match_patch.prototype.diff_charsToLines=function(b,a){for(var c=0;c<b.length;c++){for(var d=b[c][1],e=[],f=0;f<d.length;f++)e[f]=a[d.charCodeAt(f)];b[c][1]=e.join("")}};
diff_match_patch.prototype.diff_map=function(b,a,c){var d=b.length,e=a.length,f=d+e-1,g=this.Diff_DualThreshold*2<f,h=[],j=[],i={},n={};i[1]=0;n[1]=0;for(var k,p,r,q={},u=!1,s=(d+e)%2,o=0;o<f;o++){if((new Date).getTime()>c)break;h[o]={};for(var t=-o;t<=o;t+=2){k=t==-o||t!=o&&i[t-1]<i[t+1]?i[t+1]:i[t-1]+1;p=k-t;g&&(r=k+","+p,s&&q[r]!==void 0&&(u=!0),s||(q[r]=o));for(;!u&&k<d&&p<e&&b.charAt(k)==a.charAt(p);)k++,p++,g&&(r=k+","+p,s&&q[r]!==void 0&&(u=!0),s||(q[r]=o));i[t]=k;h[o][k+","+p]=!0;if(k==d&&
p==e)return this.diff_path1(h,b,a);else if(u)return j=j.slice(0,q[r]+1),c=this.diff_path1(h,b.substring(0,k),a.substring(0,p)),c.concat(this.diff_path2(j,b.substring(k),a.substring(p)))}if(g){j[o]={};for(t=-o;t<=o;t+=2){k=t==-o||t!=o&&n[t-1]<n[t+1]?n[t+1]:n[t-1]+1;p=k-t;r=d-k+","+(e-p);!s&&q[r]!==void 0&&(u=!0);for(s&&(q[r]=o);!u&&k<d&&p<e&&b.charAt(d-k-1)==a.charAt(e-p-1);)k++,p++,r=d-k+","+(e-p),!s&&q[r]!==void 0&&(u=!0),s&&(q[r]=o);n[t]=k;j[o][k+","+p]=!0;if(u)return h=h.slice(0,q[r]+1),c=this.diff_path1(h,
b.substring(0,d-k),a.substring(0,e-p)),c.concat(this.diff_path2(j,b.substring(d-k),a.substring(e-p)))}}}return[[DIFF_DELETE,b],[DIFF_INSERT,a]]};
diff_match_patch.prototype.diff_path1=function(b,a,c){for(var d=[],e=a.length,f=c.length,g=null,h=b.length-2;h>=0;h--)for(;;)if(b[h][e-1+","+f]!==void 0){e--;g===DIFF_DELETE?d[0][1]=a.charAt(e)+d[0][1]:d.unshift([DIFF_DELETE,a.charAt(e)]);g=DIFF_DELETE;break}else if(b[h][e+","+(f-1)]!==void 0){f--;g===DIFF_INSERT?d[0][1]=c.charAt(f)+d[0][1]:d.unshift([DIFF_INSERT,c.charAt(f)]);g=DIFF_INSERT;break}else{e--;f--;if(a.charAt(e)!=c.charAt(f))throw Error("No diagonal.  Can't happen. (diff_path1)");g===
DIFF_EQUAL?d[0][1]=a.charAt(e)+d[0][1]:d.unshift([DIFF_EQUAL,a.charAt(e)]);g=DIFF_EQUAL}return d};
diff_match_patch.prototype.diff_path2=function(b,a,c){for(var d=[],e=0,f=a.length,g=c.length,h=null,j=b.length-2;j>=0;j--)for(;;)if(b[j][f-1+","+g]!==void 0){f--;h===DIFF_DELETE?d[e-1][1]+=a.charAt(a.length-f-1):d[e++]=[DIFF_DELETE,a.charAt(a.length-f-1)];h=DIFF_DELETE;break}else if(b[j][f+","+(g-1)]!==void 0){g--;h===DIFF_INSERT?d[e-1][1]+=c.charAt(c.length-g-1):d[e++]=[DIFF_INSERT,c.charAt(c.length-g-1)];h=DIFF_INSERT;break}else{f--;g--;if(a.charAt(a.length-f-1)!=c.charAt(c.length-g-1))throw Error("No diagonal.  Can't happen. (diff_path2)");
h===DIFF_EQUAL?d[e-1][1]+=a.charAt(a.length-f-1):d[e++]=[DIFF_EQUAL,a.charAt(a.length-f-1)];h=DIFF_EQUAL}return d};diff_match_patch.prototype.diff_commonPrefix=function(b,a){if(!b||!a||b.charAt(0)!=a.charAt(0))return 0;for(var c=0,d=Math.min(b.length,a.length),e=d,f=0;c<e;)b.substring(f,e)==a.substring(f,e)?f=c=e:d=e,e=Math.floor((d-c)/2+c);return e};
diff_match_patch.prototype.diff_commonSuffix=function(b,a){if(!b||!a||b.charAt(b.length-1)!=a.charAt(a.length-1))return 0;for(var c=0,d=Math.min(b.length,a.length),e=d,f=0;c<e;)b.substring(b.length-e,b.length-f)==a.substring(a.length-e,a.length-f)?f=c=e:d=e,e=Math.floor((d-c)/2+c);return e};
diff_match_patch.prototype.diff_commonOverlap=function(b,a){var c=b.length,d=a.length;if(c==0||d==0)return 0;c>d?b=b.substring(c-d):c<d&&(a=a.substring(0,c));c=Math.min(c,d);if(b==a)return c;for(var d=0,e=1;;){var f=b.substring(c-e),f=a.indexOf(f);if(f==-1)return d;e+=f;if(f==0||b.substring(c-e)==a.substring(0,e))d=e,e++}};
diff_match_patch.prototype.diff_halfMatch=function(b,a){function c(a,b,c){for(var d=a.substring(c,c+Math.floor(a.length/4)),e=-1,g="",h,j,o,t;(e=b.indexOf(d,e+1))!=-1;){var y=f.diff_commonPrefix(a.substring(c),b.substring(e)),v=f.diff_commonSuffix(a.substring(0,c),b.substring(0,e));g.length<v+y&&(g=b.substring(e-v,e)+b.substring(e,e+y),h=a.substring(0,c-v),j=a.substring(c+y),o=b.substring(0,e-v),t=b.substring(e+y))}return g.length>=a.length/2?[h,j,o,t,g]:null}var d=b.length>a.length?b:a,e=b.length>
a.length?a:b;if(d.length<4||e.length*2<d.length)return null;var f=this,g=c(d,e,Math.ceil(d.length/4)),d=c(d,e,Math.ceil(d.length/2));if(!g&&!d)return null;else g=d?g?g[4].length>d[4].length?g:d:d:g;var h,j;b.length>a.length?(d=g[0],e=g[1],h=g[2],j=g[3]):(h=g[0],j=g[1],d=g[2],e=g[3]);return[d,e,h,j,g[4]]};
diff_match_patch.prototype.diff_cleanupSemantic=function(b){for(var a=!1,c=[],d=0,e=null,f=0,g=0,h=0,j=0,i=0;f<b.length;)b[f][0]==DIFF_EQUAL?(c[d++]=f,g=j,h=i,i=j=0,e=b[f][1]):(b[f][0]==DIFF_INSERT?j+=b[f][1].length:i+=b[f][1].length,e!==null&&e.length<=Math.max(g,h)&&e.length<=Math.max(j,i)&&(b.splice(c[d-1],0,[DIFF_DELETE,e]),b[c[d-1]+1][0]=DIFF_INSERT,d--,d--,f=d>0?c[d-1]:-1,i=j=h=g=0,e=null,a=!0)),f++;a&&this.diff_cleanupMerge(b);this.diff_cleanupSemanticLossless(b);for(f=1;f<b.length;){if(b[f-
1][0]==DIFF_DELETE&&b[f][0]==DIFF_INSERT){a=b[f-1][1];c=b[f][1];if(d=this.diff_commonOverlap(a,c))b.splice(f,0,[DIFF_EQUAL,c.substring(0,d)]),b[f-1][1]=a.substring(0,a.length-d),b[f+1][1]=c.substring(d),f++;f++}f++}};
diff_match_patch.prototype.diff_cleanupSemanticLossless=function(b){function a(a,b){if(!a||!b)return 5;var h=0;if(a.charAt(a.length-1).match(c)||b.charAt(0).match(c))if(h++,a.charAt(a.length-1).match(d)||b.charAt(0).match(d))if(h++,a.charAt(a.length-1).match(e)||b.charAt(0).match(e))h++,(a.match(f)||b.match(g))&&h++;return h}for(var c=/[^a-zA-Z0-9]/,d=/\s/,e=/[\r\n]/,f=/\n\r?\n$/,g=/^\r?\n\r?\n/,h=1;h<b.length-1;){if(b[h-1][0]==DIFF_EQUAL&&b[h+1][0]==DIFF_EQUAL){var j=b[h-1][1],i=b[h][1],n=b[h+1][1],
k=this.diff_commonSuffix(j,i);if(k)var p=i.substring(i.length-k),j=j.substring(0,j.length-k),i=p+i.substring(0,i.length-k),n=p+n;for(var k=j,p=i,r=n,q=a(j,i)+a(i,n);i.charAt(0)===n.charAt(0);){j+=i.charAt(0);var i=i.substring(1)+n.charAt(0),n=n.substring(1),u=a(j,i)+a(i,n);u>=q&&(q=u,k=j,p=i,r=n)}b[h-1][1]!=k&&(k?b[h-1][1]=k:(b.splice(h-1,1),h--),b[h][1]=p,r?b[h+1][1]=r:(b.splice(h+1,1),h--))}h++}};
diff_match_patch.prototype.diff_cleanupEfficiency=function(b){for(var a=!1,c=[],d=0,e="",f=0,g=!1,h=!1,j=!1,i=!1;f<b.length;){if(b[f][0]==DIFF_EQUAL)b[f][1].length<this.Diff_EditCost&&(j||i)?(c[d++]=f,g=j,h=i,e=b[f][1]):(d=0,e=""),j=i=!1;else if(b[f][0]==DIFF_DELETE?i=!0:j=!0,e&&(g&&h&&j&&i||e.length<this.Diff_EditCost/2&&g+h+j+i==3))b.splice(c[d-1],0,[DIFF_DELETE,e]),b[c[d-1]+1][0]=DIFF_INSERT,d--,e="",g&&h?(j=i=!0,d=0):(d--,f=d>0?c[d-1]:-1,j=i=!1),a=!0;f++}a&&this.diff_cleanupMerge(b)};
diff_match_patch.prototype.diff_cleanupMerge=function(b){b.push([DIFF_EQUAL,""]);for(var a=0,c=0,d=0,e="",f="",g;a<b.length;)switch(b[a][0]){case DIFF_INSERT:d++;f+=b[a][1];a++;break;case DIFF_DELETE:c++;e+=b[a][1];a++;break;case DIFF_EQUAL:c+d>1?(c!==0&&d!==0&&(g=this.diff_commonPrefix(f,e),g!==0&&(a-c-d>0&&b[a-c-d-1][0]==DIFF_EQUAL?b[a-c-d-1][1]+=f.substring(0,g):(b.splice(0,0,[DIFF_EQUAL,f.substring(0,g)]),a++),f=f.substring(g),e=e.substring(g)),g=this.diff_commonSuffix(f,e),g!==0&&(b[a][1]=f.substring(f.length-
g)+b[a][1],f=f.substring(0,f.length-g),e=e.substring(0,e.length-g))),c===0?b.splice(a-c-d,c+d,[DIFF_INSERT,f]):d===0?b.splice(a-c-d,c+d,[DIFF_DELETE,e]):b.splice(a-c-d,c+d,[DIFF_DELETE,e],[DIFF_INSERT,f]),a=a-c-d+(c?1:0)+(d?1:0)+1):a!==0&&b[a-1][0]==DIFF_EQUAL?(b[a-1][1]+=b[a][1],b.splice(a,1)):a++,c=d=0,f=e=""}b[b.length-1][1]===""&&b.pop();c=!1;for(a=1;a<b.length-1;)b[a-1][0]==DIFF_EQUAL&&b[a+1][0]==DIFF_EQUAL&&(b[a][1].substring(b[a][1].length-b[a-1][1].length)==b[a-1][1]?(b[a][1]=b[a-1][1]+b[a][1].substring(0,
b[a][1].length-b[a-1][1].length),b[a+1][1]=b[a-1][1]+b[a+1][1],b.splice(a-1,1),c=!0):b[a][1].substring(0,b[a+1][1].length)==b[a+1][1]&&(b[a-1][1]+=b[a+1][1],b[a][1]=b[a][1].substring(b[a+1][1].length)+b[a+1][1],b.splice(a+1,1),c=!0)),a++;c&&this.diff_cleanupMerge(b)};
diff_match_patch.prototype.diff_xIndex=function(b,a){var c=0,d=0,e=0,f=0,g;for(g=0;g<b.length;g++){b[g][0]!==DIFF_INSERT&&(c+=b[g][1].length);b[g][0]!==DIFF_DELETE&&(d+=b[g][1].length);if(c>a)break;e=c;f=d}return b.length!=g&&b[g][0]===DIFF_DELETE?f:f+(a-e)};
diff_match_patch.prototype.diff_prettyHtml=function(b){for(var a=[],c=0,d=/&/g,e=/</g,f=/>/g,g=/\n/g,h=0;h<b.length;h++){var j=b[h][0],i=b[h][1],n=i.replace(d,"&amp;").replace(e,"&lt;").replace(f,"&gt;").replace(g,"&para;<BR>");switch(j){case DIFF_INSERT:a[h]='<INS STYLE="background:#E6FFE6;" TITLE="i='+c+'">'+n+"</INS>";break;case DIFF_DELETE:a[h]='<DEL STYLE="background:#FFE6E6;" TITLE="i='+c+'">'+n+"</DEL>";break;case DIFF_EQUAL:a[h]='<SPAN TITLE="i='+c+'">'+n+"</SPAN>"}j!==DIFF_DELETE&&(c+=i.length)}return a.join("")};
diff_match_patch.prototype.diff_text1=function(b){for(var a=[],c=0;c<b.length;c++)b[c][0]!==DIFF_INSERT&&(a[c]=b[c][1]);return a.join("")};diff_match_patch.prototype.diff_text2=function(b){for(var a=[],c=0;c<b.length;c++)b[c][0]!==DIFF_DELETE&&(a[c]=b[c][1]);return a.join("")};
diff_match_patch.prototype.diff_levenshtein=function(b){for(var a=0,c=0,d=0,e=0;e<b.length;e++){var f=b[e][1];switch(b[e][0]){case DIFF_INSERT:c+=f.length;break;case DIFF_DELETE:d+=f.length;break;case DIFF_EQUAL:a+=Math.max(c,d),d=c=0}}a+=Math.max(c,d);return a};
diff_match_patch.prototype.diff_toDelta=function(b){for(var a=[],c=0;c<b.length;c++)switch(b[c][0]){case DIFF_INSERT:a[c]="+"+encodeURI(b[c][1]);break;case DIFF_DELETE:a[c]="-"+b[c][1].length;break;case DIFF_EQUAL:a[c]="="+b[c][1].length}return a.join("\t").replace(/%20/g," ")};
diff_match_patch.prototype.diff_fromDelta=function(b,a){for(var c=[],d=0,e=0,f=a.split(/\t/g),g=0;g<f.length;g++){var h=f[g].substring(1);switch(f[g].charAt(0)){case "+":try{c[d++]=[DIFF_INSERT,decodeURI(h)]}catch(j){throw Error("Illegal escape in diff_fromDelta: "+h);}break;case "-":case "=":var i=parseInt(h,10);if(isNaN(i)||i<0)throw Error("Invalid number in diff_fromDelta: "+h);h=b.substring(e,e+=i);f[g].charAt(0)=="="?c[d++]=[DIFF_EQUAL,h]:c[d++]=[DIFF_DELETE,h];break;default:if(f[g])throw Error("Invalid diff operation in diff_fromDelta: "+
f[g]);}}if(e!=b.length)throw Error("Delta length ("+e+") does not equal source text length ("+b.length+").");return c};diff_match_patch.prototype.match_main=function(b,a,c){if(b==null||a==null||c==null)throw Error("Null input. (match_main)");c=Math.max(0,Math.min(c,b.length));return b==a?0:b.length?b.substring(c,c+a.length)==a?c:this.match_bitap(b,a,c):-1};
diff_match_patch.prototype.match_bitap=function(b,a,c){function d(b,d){var e=b/a.length,g=Math.abs(c-d);return!f.Match_Distance?g?1:e:e+g/f.Match_Distance}if(a.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var e=this.match_alphabet(a),f=this,g=this.Match_Threshold,h=b.indexOf(a,c);h!=-1&&(g=Math.min(d(0,h),g),h=b.lastIndexOf(a,c+a.length),h!=-1&&(g=Math.min(d(0,h),g)));for(var j=1<<a.length-1,h=-1,i,n,k=a.length+b.length,p,r=0;r<a.length;r++){i=0;for(n=k;i<n;)d(r,c+n)<=
g?i=n:k=n,n=Math.floor((k-i)/2+i);k=n;i=Math.max(1,c-n+1);var q=Math.min(c+n,b.length)+a.length;n=Array(q+2);for(n[q+1]=(1<<r)-1;q>=i;q--){var u=e[b.charAt(q-1)];n[q]=r===0?(n[q+1]<<1|1)&u:(n[q+1]<<1|1)&u|(p[q+1]|p[q])<<1|1|p[q+1];if(n[q]&j&&(u=d(r,q-1),u<=g))if(g=u,h=q-1,h>c)i=Math.max(1,2*c-h);else break}if(d(r+1,c)>g)break;p=n}return h};diff_match_patch.prototype.match_alphabet=function(b){for(var a={},c=0;c<b.length;c++)a[b.charAt(c)]=0;for(c=0;c<b.length;c++)a[b.charAt(c)]|=1<<b.length-c-1;return a};
diff_match_patch.prototype.patch_addContext=function(b,a){if(a.length!=0){for(var c=a.substring(b.start2,b.start2+b.length1),d=0;a.indexOf(c)!=a.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)d+=this.Patch_Margin,c=a.substring(b.start2-d,b.start2+b.length1+d);d+=this.Patch_Margin;(c=a.substring(b.start2-d,b.start2))&&b.diffs.unshift([DIFF_EQUAL,c]);(d=a.substring(b.start2+b.length1,b.start2+b.length1+d))&&b.diffs.push([DIFF_EQUAL,d]);b.start1-=c.length;b.start2-=
c.length;b.length1+=c.length+d.length;b.length2+=c.length+d.length}};
diff_match_patch.prototype.patch_make=function(b,a,c){var d;if(typeof b=="string"&&typeof a=="string"&&typeof c=="undefined")d=b,a=this.diff_main(d,a,!0),a.length>2&&(this.diff_cleanupSemantic(a),this.diff_cleanupEfficiency(a));else if(b&&typeof b=="object"&&typeof a=="undefined"&&typeof c=="undefined")a=b,d=this.diff_text1(a);else if(typeof b=="string"&&a&&typeof a=="object"&&typeof c=="undefined")d=b;else if(typeof b=="string"&&typeof a=="string"&&c&&typeof c=="object")d=b,a=c;else throw Error("Unknown call format to patch_make.");
if(a.length===0)return[];for(var c=[],b=new patch_obj,e=0,f=0,g=0,h=d,j=0;j<a.length;j++){var i=a[j][0],n=a[j][1];if(!e&&i!==DIFF_EQUAL)b.start1=f,b.start2=g;switch(i){case DIFF_INSERT:b.diffs[e++]=a[j];b.length2+=n.length;d=d.substring(0,g)+n+d.substring(g);break;case DIFF_DELETE:b.length1+=n.length;b.diffs[e++]=a[j];d=d.substring(0,g)+d.substring(g+n.length);break;case DIFF_EQUAL:n.length<=2*this.Patch_Margin&&e&&a.length!=j+1?(b.diffs[e++]=a[j],b.length1+=n.length,b.length2+=n.length):n.length>=
2*this.Patch_Margin&&e&&(this.patch_addContext(b,h),c.push(b),b=new patch_obj,e=0,h=d,f=g)}i!==DIFF_INSERT&&(f+=n.length);i!==DIFF_DELETE&&(g+=n.length)}e&&(this.patch_addContext(b,h),c.push(b));return c};diff_match_patch.prototype.patch_deepCopy=function(b){for(var a=[],c=0;c<b.length;c++){var d=b[c],e=new patch_obj;e.diffs=[];for(var f=0;f<d.diffs.length;f++)e.diffs[f]=d.diffs[f].slice();e.start1=d.start1;e.start2=d.start2;e.length1=d.length1;e.length2=d.length2;a[c]=e}return a};
diff_match_patch.prototype.patch_apply=function(b,a){if(b.length==0)return[a,[]];var b=this.patch_deepCopy(b),c=this.patch_addPadding(b),a=c+a+c;this.patch_splitMax(b);for(var d=0,e=[],f=0;f<b.length;f++){var g=b[f].start2+d,h=this.diff_text1(b[f].diffs),j,i=-1;if(h.length>this.Match_MaxBits){if(j=this.match_main(a,h.substring(0,this.Match_MaxBits),g),j!=-1&&(i=this.match_main(a,h.substring(h.length-this.Match_MaxBits),g+h.length-this.Match_MaxBits),i==-1||j>=i))j=-1}else j=this.match_main(a,h,g);
if(j==-1)e[f]=!1,d-=b[f].length2-b[f].length1;else if(e[f]=!0,d=j-g,g=i==-1?a.substring(j,j+h.length):a.substring(j,i+this.Match_MaxBits),h==g)a=a.substring(0,j)+this.diff_text2(b[f].diffs)+a.substring(j+h.length);else if(g=this.diff_main(h,g,!1),h.length>this.Match_MaxBits&&this.diff_levenshtein(g)/h.length>this.Patch_DeleteThreshold)e[f]=!1;else{this.diff_cleanupSemanticLossless(g);for(var h=0,n,i=0;i<b[f].diffs.length;i++){var k=b[f].diffs[i];k[0]!==DIFF_EQUAL&&(n=this.diff_xIndex(g,h));k[0]===
DIFF_INSERT?a=a.substring(0,j+n)+k[1]+a.substring(j+n):k[0]===DIFF_DELETE&&(a=a.substring(0,j+n)+a.substring(j+this.diff_xIndex(g,h+k[1].length)));k[0]!==DIFF_DELETE&&(h+=k[1].length)}}}a=a.substring(c.length,a.length-c.length);return[a,e]};
diff_match_patch.prototype.patch_addPadding=function(b){for(var a=this.Patch_Margin,c="",d=1;d<=a;d++)c+=String.fromCharCode(d);for(d=0;d<b.length;d++)b[d].start1+=a,b[d].start2+=a;var d=b[0],e=d.diffs;if(e.length==0||e[0][0]!=DIFF_EQUAL)e.unshift([DIFF_EQUAL,c]),d.start1-=a,d.start2-=a,d.length1+=a,d.length2+=a;else if(a>e[0][1].length){var f=a-e[0][1].length;e[0][1]=c.substring(e[0][1].length)+e[0][1];d.start1-=f;d.start2-=f;d.length1+=f;d.length2+=f}d=b[b.length-1];e=d.diffs;e.length==0||e[e.length-
1][0]!=DIFF_EQUAL?(e.push([DIFF_EQUAL,c]),d.length1+=a,d.length2+=a):a>e[e.length-1][1].length&&(f=a-e[e.length-1][1].length,e[e.length-1][1]+=c.substring(0,f),d.length1+=f,d.length2+=f);return c};
diff_match_patch.prototype.patch_splitMax=function(b){for(var a=this.Match_MaxBits,c=0;c<b.length;c++)if(b[c].length1>a){var d=b[c];b.splice(c--,1);for(var e=d.start1,f=d.start2,g="";d.diffs.length!==0;){var h=new patch_obj,j=!0;h.start1=e-g.length;h.start2=f-g.length;if(g!=="")h.length1=h.length2=g.length,h.diffs.push([DIFF_EQUAL,g]);for(;d.diffs.length!==0&&h.length1<a-this.Patch_Margin;){var g=d.diffs[0][0],i=d.diffs[0][1];g===DIFF_INSERT?(h.length2+=i.length,f+=i.length,h.diffs.push(d.diffs.shift()),
j=!1):g===DIFF_DELETE&&h.diffs.length==1&&h.diffs[0][0]==DIFF_EQUAL&&i.length>2*a?(h.length1+=i.length,e+=i.length,j=!1,h.diffs.push([g,i]),d.diffs.shift()):(i=i.substring(0,a-h.length1-this.Patch_Margin),h.length1+=i.length,e+=i.length,g===DIFF_EQUAL?(h.length2+=i.length,f+=i.length):j=!1,h.diffs.push([g,i]),i==d.diffs[0][1]?d.diffs.shift():d.diffs[0][1]=d.diffs[0][1].substring(i.length))}g=this.diff_text2(h.diffs);g=g.substring(g.length-this.Patch_Margin);i=this.diff_text1(d.diffs).substring(0,
this.Patch_Margin);i!==""&&(h.length1+=i.length,h.length2+=i.length,h.diffs.length!==0&&h.diffs[h.diffs.length-1][0]===DIFF_EQUAL?h.diffs[h.diffs.length-1][1]+=i:h.diffs.push([DIFF_EQUAL,i]));j||b.splice(++c,0,h)}}};diff_match_patch.prototype.patch_toText=function(b){for(var a=[],c=0;c<b.length;c++)a[c]=b[c];return a.join("")};
diff_match_patch.prototype.patch_fromText=function(b){var a=[];if(!b)return a;for(var b=b.split("\n"),c=0,d=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;c<b.length;){var e=b[c].match(d);if(!e)throw Error("Invalid patch string: "+b[c]);var f=new patch_obj;a.push(f);f.start1=parseInt(e[1],10);e[2]===""?(f.start1--,f.length1=1):e[2]=="0"?f.length1=0:(f.start1--,f.length1=parseInt(e[2],10));f.start2=parseInt(e[3],10);e[4]===""?(f.start2--,f.length2=1):e[4]=="0"?f.length2=0:(f.start2--,f.length2=parseInt(e[4],
10));for(c++;c<b.length;){e=b[c].charAt(0);try{var g=decodeURI(b[c].substring(1))}catch(h){throw Error("Illegal escape in patch_fromText: "+g);}if(e=="-")f.diffs.push([DIFF_DELETE,g]);else if(e=="+")f.diffs.push([DIFF_INSERT,g]);else if(e==" ")f.diffs.push([DIFF_EQUAL,g]);else if(e=="@")break;else if(e!=="")throw Error('Invalid patch mode "'+e+'" in: '+g);c++}}return a};function patch_obj(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0}
patch_obj.prototype.toString=function(){for(var b=["@@ -"+(this.length1===0?this.start1+",0":this.length1==1?this.start1+1:this.start1+1+","+this.length1)+" +"+(this.length2===0?this.start2+",0":this.length2==1?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],a,c=0;c<this.diffs.length;c++){switch(this.diffs[c][0]){case DIFF_INSERT:a="+";break;case DIFF_DELETE:a="-";break;case DIFF_EQUAL:a=" "}b[c+1]=a+encodeURI(this.diffs[c][1])+"\n"}return b.join("").replace(/%20/g," ")};
window.diff_match_patch=diff_match_patch;window.patch_obj=patch_obj;window.DIFF_DELETE=DIFF_DELETE;window.DIFF_INSERT=DIFF_INSERT;window.DIFF_EQUAL=DIFF_EQUAL;(function(b){window.PTL=window.PTL||{};PTL.utils={getHash:function(a){return(a||window).location.toString().split("#",2)[1]||""},decodeURIParameter:function(a){return decodeURIComponent(a.replace(/\+/g," "))},getParsedHash:function(a){var b={},d=/([^&;=]+)=?([^&;]*)/g;a==void 0&&(a=this.getHash());for(var e;e=d.exec(a);)b[this.decodeURIParameter(e[1])]=this.decodeURIParameter(e[2]);return b},updateHashPart:function(a,c,d){for(var e=[],f=/([^&;=]+)=?([^&;]*)/g,g=this.getHash(),h,j;h=f.exec(g);){var i=
this.decodeURIParameter(h[1]);i==a?(e.push(h[1]+"="+encodeURIComponent(c)),j=!0):b.inArray(i,d)==-1&&e.push(h[1]+"="+h[2])}j||e.push(encodeURIComponent(a)+"="+encodeURIComponent(c));return e.join("&")}};Object.size=function(a){var b=0,d;for(d in a)a.hasOwnProperty(d)&&b++;return b};PTL.editor={init:function(a){this.settings={secure:!1,mt:[]};a&&b.extend(this.settings,a);this.units={};this.store=b("div#pootle_path").text();this.directory=b("div#directory").text();this.currentPage=1;this.currentNumPages=
0;this.pagesGot={};this.filter="all";this.checks=[];this.ctxtGap=0;this.preventNavigation=this.keepState=!1;this.isLoading=!0;this.showActivity();this.searchFields=[];this.searchOptions=["source","target","notes","locations"];this.cpRE=/^(<[^>]+>|\[n\|t]|\W$^\n)*(\b|$)/gm;this.escapeRE=/<[^<]*?>|\r\n|[\r\n\t&<>]/gm;this.searchRE=/^in:.+|\sin:.+/i;this.tmReq=null;this.differencer=new diff_match_patch;this.tmpl={vUnit:b.template(b("#view_unit").html()),tm:b.template(b("#tm_suggestions").html())};this.focused=
b(".translate-original-focus textarea").get(0);b("textarea.translation").live("keyup blur",function(){!PTL.editor.keepState&&b(this).attr("defaultValue")!=b(this).val()&&PTL.editor.ungoFuzzy()});b("input.fuzzycheck").live("click",function(){PTL.editor.isFuzzy()?PTL.editor.doFuzzyArea():PTL.editor.undoFuzzyArea()});b(".switch-suggest-mode a").live("click",function(){PTL.editor.toggleSuggestMode();return!1});b(".focusthis").live("focus",function(a){PTL.editor.focused=a.target});b(".writetm, .writespecial, .translate-full .highlight-escape, .translate-full .highlight-html").live("click",
this.copyText);b("a.copyoriginal").live("click",function(){var a=b(".translation-text",b(this).parent().parent().parent());PTL.editor.copyOriginal(a)});b("div.suggestion").live("click",function(){if(PTL.editor.getSelectedText()==""&&!b("#id_target_f_0").attr("disabled")){var a=b(".suggestion-translation",this);a.length&&PTL.editor.copyOriginal(a);a=b(".suggestion-comment",this);a.length&&(comment_textarea=b("#id_translator_comment"),comment_textarea.val(a.text()))}});b("table.translate-table").live("editor_ready",
this.ready);b("tr.view-row").live("click",this.gotoUnit);b("input#item-number").live("keypress",function(a){a.keyCode==13&&PTL.editor.gotoPage(parseInt(b("input#item-number").val()))});b("input.submit, input.suggest").live("click",this.processSubmit);b("input.previous, input.next").live("click",this.gotoPrevNext);b("#suggestion-container .rejectsugg").live("click",this.rejectSuggestion);b("#suggestion-container .acceptsugg").live("click",this.acceptSuggestion);b("#suggestion-container .clearvote").live("click",
this.clearVote);b("#suggestion-container .voteup").live("click",this.voteUp);b("#translate-checks-block .rejectcheck").live("click",this.rejectCheck);b("div#filter-status select").live("change",this.filterStatus);b("div#filter-checks select").live("change",this.filterChecks);b("a.morecontext").live("click",this.getMoreContext);b("input#id_search").live("keypress",function(a){a.keyCode==13&&(a.preventDefault(),PTL.editor.search())});shortcut.add("ctrl+return",function(){PTL.editor.isSuggestMode()?
b("input.suggest").trigger("click"):b("input.submit").trigger("click")});shortcut.add("ctrl+space",function(a){a&&a.preventDefault&&a.preventDefault();PTL.editor.keepState=!0;PTL.editor.isFuzzy()?PTL.editor.ungoFuzzy():PTL.editor.goFuzzy()});shortcut.add("ctrl+shift+space",function(){PTL.editor.toggleSuggestMode()});shortcut.add("ctrl+up",function(){b("input.previous").trigger("click")});shortcut.add("ctrl+down",function(){b("input.next").trigger("click")});shortcut.add("ctrl+shift+home",function(){PTL.editor.gotoFirstPage()});
shortcut.add("ctrl+shift+end",function(){PTL.editor.gotoLastPage()});shortcut.add("ctrl+shift+pageup",function(){PTL.editor.gotoPrevPage()});shortcut.add("ctrl+shift+pagedown",function(){PTL.editor.gotoNextPage()});shortcut.add("ctrl+shift+u",function(){b("input#item-number").focus().select()});shortcut.add("ctrl+shift+s",function(){b("#id_search").focus().select()});b("#id_search").focus(function(){b(this).attr("focused",!0)});b("#id_search").blur(function(){b(this).attr("focused","")});shortcut.add("escape",
function(){b("#id_search").attr("focused")&&b("#id_search").blur()});b(document).ajaxStart(function(){clearTimeout(PTL.editor.delayedActivityTimer);PTL.editor.delayedActivityTimer=setTimeout(function(){PTL.editor.showActivity()},3E3)});b(document).ajaxStop(function(){clearTimeout(PTL.editor.delayedActivityTimer);PTL.editor.isLoading||PTL.editor.hideActivity()});b.each(this.settings.mt,function(){var a=this.name,d=this.key;b.ajax({url:m("js/mt/"+a+".js"),async:!1,dataType:"script",success:function(){setTimeout(function(){PTL.editor.mt[a].init(d)},
0);b("table.translate-table").live("mt_ready",PTL.editor.mt[a].ready)}})});b.each(this.settings.lookup,function(){var a=this;b.ajax({url:m("js/lookup/"+a+".js"),async:!1,dataType:"script",success:function(){setTimeout(function(){PTL.editor.lookup[a].init()},0);b("table.translate-table").live("lookup_ready",PTL.editor.lookup[a].ready)}})});setTimeout(function(){b.history.init(function(a){var a=PTL.utils.getParsedHash(a),d=!1,e=void 0;if("unit"in a){var f=parseInt(a.unit);if(f&&!isNaN(f))if(PTL.editor.activeUid!=
f&&PTL.editor.units[f]==void 0)PTL.editor.activeUid=f,d=!0;else{PTL.editor.activeUid=f;PTL.editor.displayEditUnit(f);return}}else"page"in a&&(f=parseInt(a.page))&&!isNaN(f)&&f>0&&(e=f);if("filter"in a)f=a.filter.split(","),PTL.editor.filter=f.shift(),PTL.editor.checks=PTL.editor.filter=="checks"?f:[];if("search"in a&&(PTL.editor.filter="search",PTL.editor.searchText=a.search,"sfields"in a))PTL.editor.searchFields=a.sfields.split(",");PTL.editor.preventNavigation=!0;b("div#filter-status select [value='"+
PTL.editor.filter+"']").attr("selected","selected");PTL.editor.filter=="checks"&&(b("div#filter-checks").length==0&&PTL.editor.filterStatus(),b("div#filter-checks select [value='"+PTL.editor.checks[0]+"']").attr("selected","selected"));PTL.editor.filter=="search"&&(b("#id_search").triggerHandler("focus"),b("#id_search").val(PTL.editor.searchText),b("div.advancedsearch input").each(function(){b.inArray(b(this).val(),PTL.editor.searchFields)>=0?b(this).attr("checked","checked"):b(this).removeAttr("checked")}));
PTL.editor.preventNavigation=!1;PTL.editor.getViewUnits({pager:!0,page:e,withUid:d});PTL.editor.hasResults&&(PTL.editor.fetchPages(!1),PTL.editor.displayEditUnit(PTL.editor.activeUid))},{unescape:!0})},1)},ready:function(){var a=b(window).height()*0.3;b("textarea.expanding").TextAreaExpander("10",a);b(".focusthis").get(0)&&b(".focusthis").get(0).focus();PTL.editor.hlSearch();PTL.editor.settings.tmUrl!=""&&PTL.editor.getTMUnits();b("table.translate-table").trigger("mt_ready");b("table.translate-table").trigger("lookup_ready");
PTL.editor.isLoading=!1;PTL.editor.hideActivity();clearTimeout(PTL.editor.delayedActivityTimer)},escapeUnsafeRegexSymbols:function(a){var b;for(b=0;b<19;b++)a=a.replace(RegExp("\\"+"\\.+*?[^]$(){}=!<>\u00a6:".charAt(b),"g"),"\\"+"\\.+*?[^]$(){}=!<>\u00a6:".charAt(b));return a},makeRegexForMultipleWords:function(a){for(var b=a.split(" "),a=0;a<b.length;a++)b[a]=this.escapeUnsafeRegexSymbols(b[a]);return"("+b.join("|")+")"},hlSearch:function(){var a=PTL.editor.filter=="search"?PTL.editor.searchText:
"",c=[],d={notes:"div.developer-comments",locations:"div.translate-locations",source:"td.translate-original, div.original div.translation-text",target:"td.translate-translation"};b.each(PTL.editor.searchFields,function(a,b){c.push(d[b])});c.length||(c=[d.source,d.target]);b(c.join(", ")).highlightRegex(RegExp(PTL.editor.makeRegexForMultipleWords(a),"i"))},hlTerms:function(){var a;b(".tm-original").each(function(){a=b(this).text();b("div.original .translation-text").highlightRegex(RegExp(PTL.editor.escapeUnsafeRegexSymbols(a),
"g"))})},copyText:function(){var a,c,d;a=b(".tm-translation",this).length?b(".tm-translation",this).text():b(this).text();c=b(PTL.editor.focused);d=c.caret().start+a.length;c.val(c.caret().replace(a));c.caret(d,d)},copyOriginal:function(a){var c=[];b.each(a,function(a){c[a]=b(this).text()});var d=b("[id^=id_target_f_]");if(d.length){for(var e=c.length-1,a=0;a<d.length;a++){var f=c[a]||c[e];b(d.get(a)).val(f)}d=b(d).get(0);d.focus();PTL.editor.goFuzzy();PTL.editor.cpRE.exec(b(d).val());a=PTL.editor.cpRE.lastIndex;
b(d).caret(a,a);PTL.editor.cpRE.lastIndex=0}},getSelectedText:function(){var a="";if(window.getSelection)a=window.getSelection();else if(document.getSelection)a=document.getSelection();else if(document.selection)a=document.selection.createRange().text;return a},escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/,"<br/>")},fancyEscape:function(a){function b(a){var c;c={"\r\n":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\r\\n")+
"<br/>\n","\r":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\r")+"<br/>\n","\n":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\n")+"<br/>\n","\t":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\t")+"\t","&":"&amp;","<":"&lt;",">":"&gt;"}[a];c==void 0&&(c='<span class="highlight-html">&lt;%s&gt;</span>'.replace(/%s/,a.slice(1,a.length-1)));return c}var d=a,a=a.match(this.escapeRE),e;for(e in a)d=d.replace(a[e],b(a[e]));return d},doDiff:function(a,c){var d,e,f="",
g="",h=this.differencer.diff_main(a,c);this.differencer.diff_cleanupSemantic(h);b.each(h,function(a,b){d=b[0];e=b[1];d==0?(g&&(f+='<span class="diff-delete">'+PTL.editor.fancyEscape(g)+"</span>",g=""),f+=PTL.editor.fancyEscape(e)):d==1?g?(f+='<span class="diff-replace">'+PTL.editor.fancyEscape(e)+"</span>",g=""):f+='<span class="diff-insert">'+PTL.editor.fancyEscape(e)+"</span>":d==-1&&(g=e)});g&&(f+='<span class="diff-delete">'+PTL.editor.fancyEscape(g)+"</span>");return f},doFuzzyArea:function(){b("tr.edit-row").addClass("fuzzy-unit")},
undoFuzzyArea:function(){b("tr.edit-row").removeClass("fuzzy-unit")},doFuzzyBox:function(){b("input.fuzzycheck").attr("checked","checked")},undoFuzzyBox:function(){b("input.fuzzycheck").removeAttr("checked")},goFuzzy:function(){if(!this.isFuzzy())this.keepState=!0,this.doFuzzyArea(),this.doFuzzyBox()},ungoFuzzy:function(){if(this.isFuzzy())this.keepState=!0,this.undoFuzzyArea(),this.undoFuzzyBox()},isFuzzy:function(){return b("input.fuzzycheck").attr("checked")},doSuggestMode:function(){b("table.translate-table").addClass("suggest-mode")},
undoSuggestMode:function(){b("table.translate-table").removeClass("suggest-mode")},isSuggestMode:function(){return b("table.translate-table").hasClass("suggest-mode")},toggleSuggestMode:function(){this.isSuggestMode()?this.undoSuggestMode():this.doSuggestMode()},showActivity:function(){b("#xhr-error").is(":hidden")&&b("#xhr-activity").show()},hideActivity:function(){b("#xhr-activity").hide()},displayError:function(a){a&&(this.hideActivity(),b("#xhr-error span").text(a).parent().stop(!0,!0).fadeIn(300).delay(2E3).fadeOut(3500))},
error:function(a,c){var d="",d=a.status==0?"Error while connecting to the server":a.status==500?"Server error":c=="timeout"?"The server seems down. Try again later.":a instanceof XMLHttpRequest?b.parseJSON(a.responseText).msg:"Unknown error";PTL.editor.displayError(d)},getReqData:function(){var a={};switch(this.filter){case "checks":if(this.checks.length)a.matchnames=this.checks.join(",");break;case "search":a.search=this.searchText;a.sfields=this.searchFields.length?this.searchFields:["source","target"];
break;case "suggestions":a.matchnames="hassuggestion";break;case "mysuggestions":a.matchnames="ownsuggestion";break;case "all":break;case "incomplete":a.unitstates="untranslated,fuzzy";break;default:a.unitstates=this.filter}return a},getViewUnits:function(a){var c,d;d=this.store?this.store+"/view":this.directory+"view.html";a=b.extend({},{async:!1,limit:0,page:this.currentPage,pager:!1,withUid:!1},a);a.limit!=0&&(d=d+"/limit/"+limit);d=l(d);c={page:a.page};if(Object.size(this.meta)==0)c.meta=!0;if(a.pager)c.pager=
a.pager;if(a.withUid)c.uid=this.activeUid,delete c.page;c=b.extend(c,this.getReqData());b.ajax({url:d,data:c,dataType:"json",async:a.async,success:function(c){if(Object.size(PTL.editor.meta)==0&&c.meta)PTL.editor.meta=c.meta;if(a.pager&&c.pager&&(PTL.editor.hasResults=!0,PTL.editor.pagesGot={},PTL.editor.units={},PTL.editor.updatePager(c.pager),c.uid))PTL.editor.activeUid=c.uid;if(c.units.length){var d=a.withUid&&c.pager?c.pager.number:a.page;PTL.editor.pagesGot[d]=[];b.each(c.units,function(){PTL.editor.units[this.id]=
this;PTL.editor.pagesGot[d].push(this.id)});PTL.editor.hasResults=!0}else PTL.editor.hasResults=!1,PTL.editor.displayError("No results."),PTL.editor.reDraw(null)},error:PTL.editor.error})},buildRows:function(a){var c,d,e,f="even",g=!0,h="";for(d=0;d<a.length;d++)c=a[d].id||a[d],e=this.units[c],h+='<tr id="row'+c+'" class="view-row '+f+'">',h+=this.tmpl.vUnit(b,{data:{meta:this.meta,unit:e}}).join(""),h+="</tr>",f=g?"odd":"even",g=!g;return h},buildCtxtRows:function(a){var c,d,e="even",f=!0,g="";for(c=
0;c<a.length;c++)d=a[c],g+='<tr id="ctxt'+d.id+'" class="context-row '+e+'">',g+=this.tmpl.vUnit(b,{data:{meta:this.meta,unit:d}}).join(""),g+="</tr>",e=f?"odd":"even",f=!f;return g},getUidsBeforeAfter:function(a){var b,d,e,f,g={before:[],after:[]},h=parseInt((this.pager.per_page-1)/2);b=this.units[a];var j={prev:"before",next:"after"};for(d in j){f=b;for(a=0;a<h;a++)f[d]!=void 0&&f[d]in this.units&&(f=this.units[f[d]],g[j[d]].push(f.id))}if(Object.size(this.units)>h)for(d in e={prev:"after",next:"before"},
j)if(g[e[d]].length<h){b=h-g[e[d]].length;f=this.units[g[j[d]][g[j[d]].length-1]];for(a=0;a<b;a++)f[d]!=void 0&&(f=this.units[f[d]],g[j[d]].push(f.id))}g.before.reverse();return g},checkUnitsLinking:function(){var a,c,d,e;for(e in this.pagesGot){e=parseInt(e);a=this.pagesGot[e][0];c=this.pagesGot[e][this.pagesGot[e].length-1];if(e>1&&(!this.units[a].hasOwnProperty("prev")||this.units[a].prev==null))d=e-1,d in this.pagesGot&&(d=this.pagesGot[d][this.pagesGot[d].length-1],b.extend(this.units[a],{prev:d}));
if(e<this.pager.num_pages&&(!this.units[c].hasOwnProperty("next")||this.units[c].next==null))d=e+1,d in this.pagesGot&&b.extend(this.units[c],{next:this.pagesGot[d][0]})}},displayEditUnit:function(a){var b;this.checkUnitsLinking();PTL.editor.hasResults&&(this.fetchPages(!0),b=this.getUidsBeforeAfter(a),a=this.buildRows(b.before)+this.getEditUnit(a)+this.buildRows(b.after),this.reDraw(a))},reDraw:function(a){var c=b("table.translate-table"),d=b("tbody",c);b("tr",d).remove();b(".tipsy").remove();d.append(a);
b(c).trigger("editor_ready")},fetchPages:function(a){var b;b=this.currentPage;var d=[b,b+1,b-1],e=[];for(b=0;b<d.length;b++)d[b]<=this.pager.num_pages&&d[b]>0&&!(d[b]in this.pagesGot)&&e.push(d[b]);for(b=0;b<e.length;b++)this.getViewUnits({async:a,page:e[b]})},updateBreadcrumbs:function(a,c){var d;if(this.dircrumbs&&this.dircrumbs!=a)this.dircrumbs=a,d=!0;if(this.storecrumbs&&this.storecrumbs!=c)this.storecrumbs=c,d=!0;d&&(d=b("#breadcrumbs").contents(),d.slice(d.index(b("#projectcrumb"))+1).remove(),
b("#projectcrumb").after(a+c))},updatePager:function(a){this.pager=a;if(this.currentPage!=a.number||this.currentNumPages!=a.num_pages)this.currentPage=a.number,this.currentNumPages=a.num_pages,b("input#item-number").val(a.number),b("span#items-count").text(a.num_pages)},createPager:function(a){var c=this.pager;if(b.inArray(a,this.pagesGot[this.currentPage])==-1){for(var d,e=this.currentPage,f=this.currentPage+1,g=!1;!g&&(e>0||f<=this.pager.num_pages);)e>0&&b.inArray(a,this.pagesGot[e])!=-1?(d=e,g=
!0):b.inArray(a,this.pagesGot[f])!=-1&&(d=f,g=!0),e--,f++;if(g)c.number=d}return c},getEditUnit:function(a){var c;c="edit-row";var d=l("/unit/edit/"+a),e=this.getReqData(),f="",g={before:[],after:[]};b.ajax({url:d,async:!1,data:e,dataType:"json",success:function(b){f=b.editor;storecrumbs=b.storecrumbs;dircrumbs=b.dircrumbs;PTL.editor.updateBreadcrumbs(dircrumbs,storecrumbs);PTL.editor.updatePager(PTL.editor.createPager(a));if(b.ctxt)PTL.editor.ctxtGap=2,g.before=b.ctxt.before,g.after=b.ctxt.after},
error:PTL.editor.error});c+=this.units[a].isfuzzy?" fuzzy-unit":"";c=(g.before.length?'<tr class="more-context before"><td colspan="2"><a class="morecontext">Show more context rows</a></td></tr>':"")+this.buildCtxtRows(g.before)+'<tr id="row'+a+'" class="'+c+'">'+f+"</tr>"+this.buildCtxtRows(g.after)+(g.after.length?'<tr class="more-context after"><td colspan="2"><a class="morecontext">Show more context rows</a></td></tr>':"");this.activeUid=a;return c},processSubmit:function(a,c){a.preventDefault();
var d,e,f,g=PTL.editor.activeUid;c==void 0?(c=b(a.target).attr("class"),d="translate"):d="captcha";f={submit:"submission",suggest:"suggestion"}[c];e=l("/unit/process/"+g+"/"+f);d=b("form#"+d).serializeObject();b.extend(d,PTL.editor.getReqData());b.ajax({url:e,type:"POST",data:d,dataType:"json",async:!1,success:function(a){if(a.captcha)b.fancybox(a.captcha),b("input#id_captcha_answer").focus();else{if(f=="submission")PTL.editor.units[g].isfuzzy=PTL.editor.isFuzzy(),b("textarea[id^=id_target_f_]").each(function(a){PTL.editor.units[g].target[a].text=
PTL.editor.fancyEscape(b(this).val())});(a=parseInt(PTL.editor.units[g].next))?(a=PTL.utils.updateHashPart("unit",a,["page"]),b.history.load(a)):PTL.editor.displayError("Congratulations, you walked through all items")}},error:PTL.editor.error})},gotoPrevNext:function(a){a.preventDefault();var c=PTL.editor.units[PTL.editor.activeUid],c={previous:c.prev,next:c.next}[b(a.target).attr("class")];c!=null?(a=PTL.utils.updateHashPart("unit",parseInt(c),["page"]),b.history.load(a)):b(a.target).attr("class")==
"previous"?PTL.editor.displayError("You reached the beginning of the list"):PTL.editor.displayError("You reached the end of the list")},gotoUnit:function(a){a.preventDefault();if(PTL.editor.getSelectedText()==""&&(a=b(this).attr("id").match(/row([0-9]+)/)))a=parseInt(a[1]),a=PTL.utils.updateHashPart("unit",a,["page"]),b.history.load(a)},gotoPage:function(a){a&&!isNaN(a)&&a>0&&a<=PTL.editor.pager.num_pages&&(a=PTL.utils.updateHashPart("page",a,["unit"]),b.history.load(a))},gotoFirstPage:function(){PTL.editor.currentNumPages>
0&&this.gotoPage(1)},gotoLastPage:function(){PTL.editor.currentNumPages>0&&this.gotoPage(PTL.editor.currentNumPages)},gotoPrevPage:function(){PTL.editor.currentNumPages>0&&this.currentPage>1&&this.gotoPage(this.currentPage-1)},gotoNextPage:function(){PTL.editor.currentNumPages>0&&this.currentPage<PTL.editor.currentNumPages&&this.gotoPage(this.currentPage+1)},getCheckOptions:function(){var a,c=this.store?l(this.store+"/checks/"):l(this.directory+"checks.html");b.ajax({url:c,async:!1,dataType:"json",
success:function(b){a=b.checks||{}},error:PTL.editor.error});return a},filterChecks:function(){if(!PTL.editor.preventNavigation){var a=b("option:selected",this).val();a!="none"&&b.history.load("filter=checks,"+a)}},filterStatus:function(){var a=b("div#filter-status option:selected").val();if(a=="checks")if(a=PTL.editor.getCheckOptions(),a.length){var c='<div id="filter-checks" class="toolbar-item">';c+='<select name="filter-checks">';c+='<option selected="selected" value="none">------</option>';b.each(a,
function(){c+='<option value="'+this.name+'">'+this.text+"</option>"});c+="</select></div>";b("div#filter-status").first().after(c)}else PTL.editor.displayError("No results."),b("#filter-status option[value="+PTL.editor.filter+"]").attr("selected","selected");else b("div#filter-checks").remove(),PTL.editor.preventNavigation||b.history.load("filter="+a)},getMoreContext:function(){var a=l("/unit/context/"+PTL.editor.activeUid);b.ajax({url:a,async:!1,dataType:"json",data:{gap:PTL.editor.ctxtGap},success:function(a){PTL.editor.ctxtGap+=
2;var d=PTL.editor.buildCtxtRows(a.ctxt.before),a=PTL.editor.buildCtxtRows(a.ctxt.after),e=b("tr.context-row");e.first().before(d);e.last().after(a)},error:PTL.editor.error})},parseSearch:function(a){var c=[],d=a;if(this.searchRE.test(a)){var e,f=[],g=a.split(" ");b.each(g,function(a,d){PTL.editor.searchRE.test(d)&&(e=d.split(":")[1],b.inArray(e,PTL.editor.searchOptions)>-1&&c.push(e),f.push(a))});b.each(f.reverse(),function(a,b){g.splice(b,1)});d=encodeURIComponent(g.join(" "))}else d=encodeURIComponent(d),
b("div.advancedsearch input:checked").each(function(){c.push(b(this).val())});c.length&&(d+="&sfields="+c.join(","));return d},search:function(){var a=b("input#id_search").val(),a=a?"search="+this.parseSearch(a):PTL.utils.updateHashPart("filter","all",["search","sfields"]);b.history.load(a)},filterTMResults:function(a){for(var c=b("[id^=id_source_f_]").first().val(),d=[],e=0;e<a.length&&e<3;e++)a[e].source=this.doDiff(c,a[e].source),a[e].target=this.fancyEscape(a[e].target),a[e].qTitle=Math.round(a[e].quality)+
"% match",d.push(a[e]);return d},getTMUnits:function(){var a=this.meta.source_lang,c=this.meta.target_lang,d=b(b("input[id^=id_source_f_]").get(0)).val(),a=this.settings.tmUrl+a+"/"+c+"/unit/?source="+encodeURIComponent(d)+"&jsoncallback=?";this.tmReq!=null&&this.tmReq.abort();this.tmReq=b.jsonp({url:a,callback:"_jsonp"+PTL.editor.activeUid,dataType:"jsonp",cache:!0,success:function(a){this.callback.slice(6)==PTL.editor.activeUid&&a.length>0&&(a=PTL.editor.filterTMResults(a),a=PTL.editor.tmpl.tm(b,
{data:{meta:PTL.editor.meta,suggs:a,name:"amaGama server"}}).join(""),b("div#suggestion-container").append(a),b("div#amagama_results").animate({height:"show"},1E3,"easeOutQuad"))},error:PTL.editor.error})},rejectSuggestion:function(a){a.stopPropagation();var c=b(this).parent().parent(),a=b(".translate-container input#id_id").val(),d=b(this).siblings("input.suggid").val(),a=l("/suggestion/reject/")+a+"/"+d;b.post(a,{reject:1},function(){c.fadeOut(200,function(){b(this).remove();b("div#suggestion-container div[id^=suggestion]").length||
b("input.next").trigger("click")})},"json")},acceptSuggestion:function(a){a.stopPropagation();var c=b(this).parent().parent(),d=b(".translate-container input#id_id").val(),a=b(this).siblings("input.suggid").val(),a=l("/suggestion/accept/")+d+"/"+a;b.post(a,{accept:1},function(a){b.each(a.newtargets,function(a,c){b("textarea#id_target_f_"+a).val(c).focus()});b.each(a.newdiffs,function(a,c){b.each(c,function(c,d){b("#suggdiff-"+a+"-"+c).html(d)})});b("textarea[id^=id_target_f_]").each(function(a){PTL.editor.units[d].target[a].text=
PTL.editor.fancyEscape(b(this).val())});PTL.editor.units[d].isfuzzy=!1;c.fadeOut(200,function(){b(this).remove();b("div#suggestion-container div[id^=suggestion]").length||b("input.next").trigger("click")})},"json")},clearVote:function(a){a.stopPropagation();var c=b(this);voteId=c.siblings("input.voteid").val();url=l("/vote/clear/")+voteId;c.fadeTo(200,0.01);b.ajax({url:url,type:"POST",data:{clear:1},dataType:"json",success:function(){c.hide();c.siblings("#suggestion-container .voteup").fadeTo(200,
1)},error:function(a,b){PTL.editor.error(a,b);c.delay(3E3).fadeTo(2E3,1)}})},voteUp:function(a){a.stopPropagation();var c=b(this);suggId=c.siblings("input.suggid").val();uid=b(".translate-container input#id_id").val();url=l("/vote/up/")+uid+"/"+suggId;c.fadeTo(200,0.01);b.ajax({url:url,type:"POST",data:{up:1},dataType:"json",success:function(a){c.siblings("input.voteid").attr("value",a.voteid);c.hide();c.siblings("#suggestion-container .clearvote").fadeTo(200,1)},error:function(a,b){PTL.editor.error(a,
b);c.delay(3E3).fadeTo(2E3,1)}})},rejectCheck:function(){var a=b(this).parent(),c=b(this).siblings("input.checkid").val(),d=b(".translate-container input#id_id").val(),c=l("/qualitycheck/reject/")+d+"/"+c;b.post(c,{reject:1},function(){a.siblings().size()==0&&(a=b("#translate-checks-block"));a.fadeOut(200,function(){b(this).remove();b(".tipsy").remove()})},"json")},isSupportedSource:function(a,b){for(var d in a)if(b==a[d].source)return!0;return!1},isSupportedTarget:function(a,b){for(var d in a)if(b==
a[d].target)return!0;return!1},isSupportedPair:function(a,b,d){for(var e in a)if(b==a[e].source&&d==a[e].target)return!0;return!1},addMTButton:function(a,c,d,e){c='<a class="translate-mt '+c+'">';c+='<img src="'+d+'" title="'+e+'" /></a>';b(a).first().prepend(c)},addMTButtons:function(a){if(this.isSupportedTarget(a.pairs,a.targetLang)){var c=this,d=b(".translate-toolbar");b(d).each(function(){var d=c.normalizeCode(b(this).parent().parent().find(".translation-text").attr("lang"));(a.validatePairs?
c.isSupportedPair(a.pairs,d,a.targetLang):c.isSupportedSource(a.pairs,d))&&c.addMTButton(this,a.buttonClassName,a.imageUri,a.hint+" ("+d.toUpperCase()+"&rarr;"+a.targetLang.toUpperCase()+")")})}},normalizeCode:function(a){var b=a.replace("_","-"),a=a.indexOf("@");a!=-1&&(b=b.slice(0,a));return b},collectArguments:function(a){this.argSubs[this.argPos]=a;return"["+this.argPos++ +"]"},translate:function(a,c){var d=b("[id^=id_target_f_]"),e=b(a).parent().parent().parent().find(".translation-text"),f=
PTL.editor.normalizeCode(e.eq(0).attr("lang")),g=PTL.editor.normalizeCode(d.eq(0).attr("lang")),h=/<[\/]?\w+.*?>/g,j=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,i=/{\d+(,\d+)?(:[a-zA-Z ]+)?}/g,n=/%\d+/g,k=this;b(e).each(function(a){var e=b(this).text();k.argSubs=[];k.argPos=0;e=e.replace(h,function(a){return k.collectArguments(a)});e=e.replace(j,function(a){return k.collectArguments(a)});e=e.replace(i,function(a){return k.collectArguments(a)});e=e.replace(n,
function(a){return k.collectArguments(a)});c(e,f,g,function(c,f){if(c===!1)PTL.editor.displayError(f);else{for(var g=0;g<k.argSubs.length;g++)e.match(RegExp("\\["+g+"\\][^\\s]"))&&(c=c.replace(RegExp("\\["+g+"\\]\\s+"),"["+g+"]")),e.match(RegExp("[^\\s]\\["+g+"\\]"))&&(c=c.replace(RegExp("\\s+\\["+g+"\\]"),"["+g+"]"));for(g=0;g<k.argSubs.length;g++)var h=k.argSubs[g].replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;"),c=c.replace("["+g+"]",h);d.eq(a).val(b("<div />").html(c).text());
d.eq(a).focus()}})});PTL.editor.goFuzzy();return!1},addLookupButton:function(a,c,d,e){c='<a class="translate-lookup iframe '+c+'">';c+='<img src="'+d+'" title="'+e+'" /></a>';b(a).first().prepend(c)},addLookupButtons:function(a){var c=this,d=b(".translate-toolbar");b(d).each(function(){var d=c.normalizeCode(b(this).parent().parent().find(".translation-text").attr("lang"));c.addLookupButton(this,a.buttonClassName,a.imageUri,a.hint+" ("+d.toUpperCase()+")")})},lookup:function(a,c){var d=b("[id^=id_target_f_]"),
e=b(a).parent().parent().parent().find(".translation-text"),f=PTL.editor.normalizeCode(e.eq(0).attr("lang")),d=PTL.editor.normalizeCode(d.eq(0).attr("lang")),g=PTL.editor.getSelectedText().toString();g||(g=e.eq(0).text());e=c(g,f,d);b.fancybox({href:e,type:"iframe",autoScale:!1,transitionIn:"none",transitionOut:"fade",width:"75%",height:"75%"});b("#fancybox-frame").css({width:"100%",height:"100%"});a.href=e;return!1}}})(jQuery);if(!this.JSON)this.JSON={};
(function(){function b(a){return a<10?"0"+a:a}function a(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(b,d){var e,h,r,q,u=f,s,o=d[b];o&&typeof o==="object"&&typeof o.toJSON==="function"&&(o=o.toJSON(b));typeof j==="function"&&(o=j.call(d,b,o));switch(typeof o){case "string":return a(o);case "number":return isFinite(o)?String(o):"null";case "boolean":case "null":return String(o);
case "object":if(!o)return"null";f+=g;s=[];if(Object.prototype.toString.apply(o)==="[object Array]"){q=o.length;for(e=0;e<q;e+=1)s[e]=c(e,o)||"null";r=s.length===0?"[]":f?"[\n"+f+s.join(",\n"+f)+"\n"+u+"]":"["+s.join(",")+"]";f=u;return r}if(j&&typeof j==="object"){q=j.length;for(e=0;e<q;e+=1)h=j[e],typeof h==="string"&&(r=c(h,o))&&s.push(a(h)+(f?": ":":")+r)}else for(h in o)Object.hasOwnProperty.call(o,h)&&(r=c(h,o))&&s.push(a(h)+(f?": ":":")+r);r=s.length===0?"{}":f?"{\n"+f+s.join(",\n"+f)+"\n"+
u+"}":"{"+s.join(",")+"}";f=u;return r}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,b,d){var e;g=f="";if(typeof d==="number")for(e=0;e<d;e+=1)g+=" ";else typeof d==="string"&&(g=d);if((j=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("JSON.stringify");return c("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,b){function c(a,d){var e,f,g=a[d];if(g&&typeof g==="object")for(e in g)Object.hasOwnProperty.call(g,e)&&(f=c(g,e),f!==void 0?g[e]=f:delete g[e]);return b.call(a,d,g)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),typeof b==="function"?c({"":e},""):e;throw new SyntaxError("JSON.parse");}})();(function(){jQuery.each({getSelection:function(){var b=this.jquery?this[0]:this;return("selectionStart"in b&&function(){var a=b.selectionEnd-b.selectionStart;return{start:b.selectionStart,end:b.selectionEnd,length:a,text:b.value.substr(b.selectionStart,a)}}||document.selection&&function(){b.focus();var a=document.selection.createRange();if(a==null)return{start:0,end:b.value.length,length:0};var c=b.createTextRange(),d=c.duplicate();c.moveToBookmark(a.getBookmark());d.setEndPoint("EndToStart",c);return{start:d.text.length,
end:d.text.length+a.text.length,length:a.text.length,text:a.text}}||function(){return{start:0,end:b.value.length,length:0}})()},replaceSelection:function(b){var a=this.jquery?this[0]:this,c=b||"";return("selectionStart"in a&&function(){a.value=a.value.substr(0,a.selectionStart)+c+a.value.substr(a.selectionEnd,a.value.length);return this}||document.selection&&function(){a.focus();document.selection.createRange().text=c;return this}||function(){a.value+=c;return this})()}},function(b){jQuery.fn[b]=
this})})();(function(b,a,c,d){b.fn.caret=function(e,f){var g,h,j=this[0],i=b.browser.msie;if(typeof e==="object"&&typeof e.start==="number"&&typeof e.end==="number")g=e.start,h=e.end;else if(typeof e==="number"&&typeof f==="number")g=e,h=f;else if(typeof e==="string")(g=j.value.indexOf(e))>-1?h=g+e[a]:g=null;else if(Object.prototype.toString.call(e)==="[object RegExp]"){var n=e.exec(j.value);if(n!=null)g=n.index,h=g+n[0][a]}if(typeof g!="undefined")return i?(i=this[0].createTextRange(),i.collapse(!0),i.moveStart("character",
g),i.moveEnd("character",h-g),i.select()):(this[0].selectionStart=g,this[0].selectionEnd=h),this[0].focus(),this;else{if(i)if(h=document.selection,this[0].tagName.toLowerCase()!="textarea"){i=this.val();g=h[c]()[d]();g.moveEnd("character",i[a]);var k=g.text==""?i[a]:i.lastIndexOf(g.text);g=h[c]()[d]();g.moveStart("character",-i[a]);var p=g.text[a]}else g=h[c](),h=g[d](),h.moveToElementText(this[0]),h.setEndPoint("EndToEnd",g),k=h.text[a]-g.text[a],p=k+g.text[a];else k=j.selectionStart,p=j.selectionEnd;
g=j.value.substring(k,p);return{start:k,end:p,text:g,replace:function(b){return j.value.substring(0,k)+b+j.value.substring(p,j.value[a])}}}}})(jQuery,"length","createRange","duplicate");(function(b){b.fn.highlightRegex=function(a){a==void 0||a.source==""?b(this).find("span.highlight").each(function(){b(this).replaceWith(b(this).text());b(this).parent().each(function(){node=b(this).get(0);node.normalize&&node.normalize()})}):b(this).each(function(){elt=b(this).get(0);elt.normalize();b.each(b.makeArray(elt.childNodes),function(c,d){if(d.nodeType==3)for(var e=d;(pos=e.data.search(a))>=0;){match=e.data.slice(pos).match(a)[0];if(match.length==0)break;var f=document.createElement("span");
f.className="highlight";var g=e.splitText(pos),e=g.splitText(match.length),h=g.cloneNode(!0);f.appendChild(h);e.parentNode.replaceChild(f,g)}else b(d).highlightRegex(a)})});return b(this)}})(jQuery);(function(b,a){b.fn.serializeObject=function(){var c={};b.each(this.serializeArray(),function(d,e){var f=e.name,g=e.value;c[f]=c[f]===a?g:b.isArray(c[f])?c[f].concat(g):[c[f],g]});return c}})(jQuery);

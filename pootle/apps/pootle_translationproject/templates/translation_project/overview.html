{% extends "tp_base.html" %}
{% load assets baseurl cache cleanhtml i18n locale progressbar search translation_project_tags common_tags profile_tags %}
{% load url from future %}
{% get_current_language as LANGUAGE_CODE %}

{% block body_id %}tpoverview{% endblock %}

{% block search %}{% render_search %}{% endblock %}

{% block content %}

<div class="hd">
  {% cache settings.CACHE_TIMEOUT path_trail resource_obj.id %}
  <h2><span><a href="{{ translation_project.pootle_path|l }}">{{ project.code }}</a> / {{ resource_obj|trail:"/" }}</span></h2>
  {% endcache %}
</div>
<div id="path-summary" class="bd">
  <ul>
    {% for summary_item in path_summary %}
    <li>{{ summary_item|safe }}</li>
    {% endfor %}
  </ul>
  {% progressbar stats stats.total.words %}
  <div id="js-path-summary-more" data-loaded="false" data-collapsed="true">
  </div>
</div>

{% if table %}
<div class="hd">
  <h2>{% trans "Files and Subfolders" %}</h2>
</div>
<div class="bd">
  <div class="files-subfolders" lang="{{ LANGUAGE_CODE }}">
    {% display_table table %}
  </div>
</div>
{% endif %}

{% endblock content %}

{% block postcontent %}
{% include "top_contributers_table.html" %}
{% endblock postcontent %}

{% block scripts_extra %}
{{ block.super }}
<script type="text/javascript">
$(function() {
  PTL.search.init();

  PTL.common.updateRelativeDates();
  setInterval(PTL.common.updateRelativeDates, 6e4);

{% if upload %}
  $("select#id_upload_to_dir").parent().hide();
  $("input#id_file").change(function() {
    if (/\.zip$/.test($(this).val())) {
      $("select#id_upload_to").parent().hide();
      $("select#id_upload_to_dir").parent().show();
    } else {
      $("select#id_upload_to_dir").parent().hide();
      $("select#id_upload_to").parent().show();
    }
  });
{% endif %}
});
</script>
{% if user.is_superuser or request.permissions.administrate %}
{% assets "js_admin" %}
<script type="text/javascript" src="{{ ASSET_URL }}"></script>
{% endassets %}
{% endif %}
{% endblock %}
